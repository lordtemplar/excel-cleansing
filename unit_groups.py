import pandas as pd

# Define unit groups
unit_groups = {
    "กลุ่มที่ 1 พล.๑ รอ.": [
        "ร.๓๑ รอ.", "ร.๓๑ พัน.๑ รอ.", "ร.๓๑ พัน.๒ รอ.", "ร.๓๑ พัน.๓ รอ.",
        "ป.๑ พัน.๑ รอ.", "ป.๑ พัน.๑๑ รอ.", "ป.๑ พัน.๓๑ รอ.",
        "ม.พัน.๔ พล.๑รอ.", "ช.พัน.๑ พล.๑ รอ.", "ส.พัน.๑"
    ],
    "กลุ่มที่ 2 พล.ร.๒ รอ.": [
        "ร.๒ รอ.", "ร.๒ พัน.๑ รอ.", "ร.๒ พัน.๒ รอ.", "ร.๒ พัน.๓ รอ.",
        "ร.๑๒ รอ.", "ร.๑๒ พัน.๑ รอ.", "ร.๑๒ พัน.๒ รอ.", "ร.๑๒ พัน.๓ รอ.",
        "ร.๒๑ รอ.", "ร.๒๑ พัน.๑ รอ.", "ร.๒๑ พัน.๒ รอ.", "ร.๒๑ พัน.๓ รอ.",
        "ป.๒ พัน.๒ รอ.", "ป.๒ พัน.๑๒ รอ.", "ป.๒ พัน.๒๑ รอ.", "ป.๒ พัน.๑๐๒ รอ.",
        "ม.พัน.๒ รอ. พล.ร.๒ รอ.", "ม.พัน.๓๐ รอ. พล.ร.๒ รอ.", "ช.พัน.๒ พล.ร.๒ รอ.",
        "ส.พัน.๒", "พัน.ซบร.กรม สน.๒"
    ],
    "กลุ่มที่ 3 พล.ร.๙ รอ.": [
        "ร.๙ พัน.๑", "ร.๙ พัน.๒", "ร.๙ พัน.๓", "ร.๑๙ พัน.๑", "ร.๑๙ พัน.๒", "ร.๑๙ พัน.๓",
        "ร.๒๙ พัน.๑", "ร.๒๙ พัน.๒", "ร.๒๙ พัน.๓", "ป.๙ พัน.๙", "ป.๙ พัน.๑๙", "ป.๙ พัน.๑๐๙",
        "พัน.ขส.กรม สน.พล.ร.๙", "พัน.ซบร.กรม สน.พล.ร.๙", "ม.พัน.๑๙ พล.ร.๙", "ช.พัน.๙ พล.ร.๙",
        "ส.พัน.๙ พล.ร.๙"
    ],
    "กลุ่มที่ 4 พล.ร.๑๑": [
        "พัน.ซบร.กรม สน.พล.ร.๑๑", "ร.๑๑๑ พัน.๑", "ร.๑๑๑ พัน.๒", "ร.๑๑๑ พัน.๓",
        "ร.๑๑๒ พัน.๑", "ร.๑๑๒ พัน.๒", "ร.๑๑๒ พัน.๓"
    ],
    "กลุ่มที่ 5 พล.ม.๒ รอ.": [
        "ม.๑ พัน.๑ รอ.", "ม.๑ พัน.๓ รอ.", "ม.๑ พัน.๑๗ รอ.", "ม.๔ พัน.๕ รอ.",
        "ม.๔ พัน.๑๑ รอ.", "ม.๔ พัน.๒๕ รอ.", "ม.๕ พัน.๒๐ รอ.", "ม.๕ พัน.๒๓ รอ.",
        "ม.๕ พัน.๒๔ รอ.", "ม.พัน.๒๗ พล.ม.๒ รอ.", "ม.พัน.๒๙ รอ.", "ส.พัน.๑๒", "พัน.ซบร.กรม สน.๑๒"
    ],
    "กลุ่มที่ 6 อื่นๆ": [
        "พัน.พัฒนา.๑", "ช.๑ พัน.๑๑๒ รอ.", "ช.๑ พัน.๕๒ รอ.", "พัน.สพ.กระสุน ๒๑ บชร.๑",
        "พัน.สบร.๒๑ บชร.๑", "หน่วยฝึกที่ ๑", "หน่วยฝึกที่ ๒", "หน่วยฝึกที่ ๓", "พัน.สห.๑๑",
        "มทบ.๑๓", "มทบ.๑๔", "มทบ.๑๕", "มทบ.๑๖", "มทบ.๑๗", "มทบ.๑๘", "มทบ.๑๙",
        "บก.ทภ.๑ (ส.พัน.๒๑ ทภ.๑)"
    ]
}

def count_by_group(df, unit_groups):
    # Count people by each group
    group_counts = {}
    for group_name, units in unit_groups.items():
        group_counts[group_name] = df["สังกัด(หน่วยฝึกทหารใหม่)"].isin(units).sum()

    return pd.DataFrame(list(group_counts.items()), columns=["กลุ่ม", "จำนวนคน"])
